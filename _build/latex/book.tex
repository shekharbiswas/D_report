%% Generated by Sphinx.
\def\sphinxdocclass{jupyterBook}
\documentclass[letterpaper,10pt,english]{jupyterBook}
\ifdefined\pdfpxdimen
   \let\sphinxpxdimen\pdfpxdimen\else\newdimen\sphinxpxdimen
\fi \sphinxpxdimen=.75bp\relax
\ifdefined\pdfimageresolution
    \pdfimageresolution= \numexpr \dimexpr1in\relax/\sphinxpxdimen\relax
\fi
%% let collapsible pdf bookmarks panel have high depth per default
\PassOptionsToPackage{bookmarksdepth=5}{hyperref}
%% turn off hyperref patch of \index as sphinx.xdy xindy module takes care of
%% suitable \hyperpage mark-up, working around hyperref-xindy incompatibility
\PassOptionsToPackage{hyperindex=false}{hyperref}
%% memoir class requires extra handling
\makeatletter\@ifclassloaded{memoir}
{\ifdefined\memhyperindexfalse\memhyperindexfalse\fi}{}\makeatother

\PassOptionsToPackage{booktabs}{sphinx}
\PassOptionsToPackage{colorrows}{sphinx}

\PassOptionsToPackage{warn}{textcomp}

\catcode`^^^^00a0\active\protected\def^^^^00a0{\leavevmode\nobreak\ }
\usepackage{cmap}
\usepackage{fontspec}
\defaultfontfeatures[\rmfamily,\sffamily,\ttfamily]{}
\usepackage{amsmath,amssymb,amstext}
\usepackage{polyglossia}
\setmainlanguage{english}



\setmainfont{FreeSerif}[
  Extension      = .otf,
  UprightFont    = *,
  ItalicFont     = *Italic,
  BoldFont       = *Bold,
  BoldItalicFont = *BoldItalic
]
\setsansfont{FreeSans}[
  Extension      = .otf,
  UprightFont    = *,
  ItalicFont     = *Oblique,
  BoldFont       = *Bold,
  BoldItalicFont = *BoldOblique,
]
\setmonofont{FreeMono}[
  Extension      = .otf,
  UprightFont    = *,
  ItalicFont     = *Oblique,
  BoldFont       = *Bold,
  BoldItalicFont = *BoldOblique,
]



\usepackage[Bjarne]{fncychap}
\usepackage[,numfigreset=1,mathnumfig]{sphinx}

\fvset{fontsize=\small}
\usepackage{geometry}


% Include hyperref last.
\usepackage{hyperref}
% Fix anchor placement for figures with captions.
\usepackage{hypcap}% it must be loaded after hyperref.
% Set up styles of URL: it should be placed after hyperref.
\urlstyle{same}


\usepackage{sphinxmessages}



        % Start of preamble defined in sphinx-jupyterbook-latex %
         \usepackage[Latin,Greek]{ucharclasses}
        \usepackage{unicode-math}
        % fixing title of the toc
        \addto\captionsenglish{\renewcommand{\contentsname}{Contents}}
        \hypersetup{
            pdfencoding=auto,
            psdextra
        }
        % End of preamble defined in sphinx-jupyterbook-latex %
        

\title{Nonparametric Trend Test Statistic}
\date{Jun 30, 2025}
\release{}
\author{Daria S}
\newcommand{\sphinxlogo}{\vbox{}}
\renewcommand{\releasename}{}
\makeindex
\begin{document}

\pagestyle{empty}
\sphinxmaketitle
\pagestyle{plain}
\sphinxtableofcontents
\pagestyle{normal}
\phantomsection\label{\detokenize{intro::doc}}


\sphinxAtStartPar
\sphinxstylestrong{Author}: Daria Suraeva\\
\sphinxstylestrong{Date}: 2025\sphinxhyphen{}06\sphinxhyphen{}27


\bigskip\hrule\bigskip



\bigskip\hrule\bigskip


\begin{DUlineblock}{0em}
\item[] \sphinxstylestrong{\Large ðŸ“‘ Table of Contents}
\end{DUlineblock}
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
{\hyperref[\detokenize{intro:1-introduction}]{\sphinxcrossref{\DUrole{xref,myst}{Introduction}}}}

\item {} 
\sphinxAtStartPar
{\hyperref[\detokenize{function::doc}]{\sphinxcrossref{\DUrole{std,std-doc}{Implementation of \sphinxcode{\sphinxupquote{nonparTrendR\_test}} Function}}}}

\item {} 
\sphinxAtStartPar
{\hyperref[\detokenize{intro:methodology.md}]{\sphinxcrossref{\DUrole{xref,myst}{Methodology}}}}
\begin{itemize}
\item {} 
\sphinxAtStartPar
3.1 {\hyperref[\detokenize{intro:methodology.md:independent-samples}]{\sphinxcrossref{\DUrole{xref,myst}{Independent Samples}}}}

\item {} 
\sphinxAtStartPar
3.2 {\hyperref[\detokenize{intro:methodology.md:dependent-samples}]{\sphinxcrossref{\DUrole{xref,myst}{Dependent Samples}}}}

\end{itemize}

\item {} 
\sphinxAtStartPar
{\hyperref[\detokenize{intro:simulation.md}]{\sphinxcrossref{\DUrole{xref,myst}{Simulation Studies}}}}
\begin{itemize}
\item {} 
\sphinxAtStartPar
4.1 {\hyperref[\detokenize{intro:simulation.md:table-1-and-table-3-replication}]{\sphinxcrossref{\DUrole{xref,myst}{Table 1 and Table 3 Replication}}}}

\item {} 
\sphinxAtStartPar
4.2 {\hyperref[\detokenize{intro:visuals.md:balanced-sample-visualization}]{\sphinxcrossref{\DUrole{xref,myst}{Balanced Sample Visualization}}}}

\item {} 
\sphinxAtStartPar
4.3 {\hyperref[\detokenize{intro:visuals.md:unbalanced-sample-visualization}]{\sphinxcrossref{\DUrole{xref,myst}{Unbalanced Sample Visualization}}}}

\end{itemize}

\item {} 
\sphinxAtStartPar
{\hyperref[\detokenize{intro:discussion.md}]{\sphinxcrossref{\DUrole{xref,myst}{Discussion and Interpretation}}}}

\item {} 
\sphinxAtStartPar
{\hyperref[\detokenize{intro:conclusion.md}]{\sphinxcrossref{\DUrole{xref,myst}{Conclusion}}}}

\item {} 
\sphinxAtStartPar
{\hyperref[\detokenize{intro:references.md}]{\sphinxcrossref{\DUrole{xref,myst}{References}}}}

\end{enumerate}

\begin{DUlineblock}{0em}
\item[] \sphinxstylestrong{\large 1. Introduction}
\end{DUlineblock}

\sphinxAtStartPar
Monotonic trends are frequently investigated in fields such as medicine, psychology, economics, and environmental science, where the progression of an outcome is expected to follow a consistent direction across ordered groups or time points. Traditional parametric approaches like linear regression or ANOVA rely heavily on assumptions such as normality and homoscedasticity, which may not hold in real\sphinxhyphen{}world data, especially when sample sizes are small or distributions are skewed.

\sphinxAtStartPar
To address these challenges, \sphinxstylestrong{nonparametric trend tests} offer a robust alternative by using rank\sphinxhyphen{}based statistics that are less sensitive to distributional assumptions. In particular, \sphinxstylestrong{Bathke (2009)} proposed a unified framework to assess monotonic trends in both \sphinxstylestrong{independent sample settings} and \sphinxstylestrong{dependent (repeated measures)} designs. This method uses a test statistic \(\hat{\nu}\) that compares weighted rank sums across ordered groups or time levels.

\sphinxAtStartPar
The current work implements Bathkeâ€™s methodology in R, offering a practical and modular solution named \sphinxcode{\sphinxupquote{nonparTrendR\_test}}. This implementation allows researchers and analysts to rigorously test for increasing or decreasing trends in their data, regardless of sample structure, while remaining distribution\sphinxhyphen{}free.

\sphinxAtStartPar
We demonstrate the test using both synthetic and real\sphinxhyphen{}world\sphinxhyphen{}inspired data, replicating key results from Bathkeâ€™s original paper, and evaluating its performance under \sphinxstylestrong{balanced} and \sphinxstylestrong{unbalanced} designs. Visualizations and simulation studies accompany the implementation to deepen understanding and support practical application.

\sphinxstepscope


\chapter{2. Implementation of \sphinxstyleliteralintitle{\sphinxupquote{nonparTrendR\_test}} Function}
\label{\detokenize{function:implementation-of-nonpartrendr-test-function}}\label{\detokenize{function::doc}}
\sphinxAtStartPar
This section presents the complete implementation of the \sphinxcode{\sphinxupquote{nonparTrendR\_test}} function in R, which is based on the methodology proposed by \sphinxstylestrong{Bathke (2009)}. The function supports both \sphinxstylestrong{independent} and \sphinxstylestrong{dependent} sample structures and returns the standardized test statistic \(\hat{\nu}\) along with the corresponding \sphinxstylestrong{p\sphinxhyphen{}value}.

\sphinxAtStartPar
The function accepts:
\begin{itemize}
\item {} 
\sphinxAtStartPar
A \sphinxstylestrong{list of numeric vectors} for independent samples (\sphinxcode{\sphinxupquote{type = "I"}})

\item {} 
\sphinxAtStartPar
A \sphinxstylestrong{numeric matrix} for dependent (repeated\sphinxhyphen{}measures) samples (\sphinxcode{\sphinxupquote{type = "D"}})

\end{itemize}

\sphinxAtStartPar
It computes weighted rank sums and estimates the test statistic \(\hat{\nu}\) using variance\sphinxhyphen{}adjusted normalization. The results help determine whether a \sphinxstylestrong{monotonic trend} (increasing or decreasing) is present across groups or time points.


\section{ðŸ”¹ Example Results}
\label{\detokenize{function:example-results}}
\sphinxAtStartPar
To demonstrate the functionâ€™s application and output:
\begin{itemize}
\item {} 
\sphinxAtStartPar
For \sphinxstylestrong{independent samples}, such as in Example 1 of Bathke (2009), the function returns:\\
\sphinxstylestrong{\(\hat{\nu} = 3.5799\) and \(p = 0.0002\)}\\
This strongly suggests a \sphinxstylestrong{significant increasing trend} across groups.

\item {} 
\sphinxAtStartPar
For \sphinxstylestrong{dependent samples}, as shown in a different setting from Bathke (2009), the function produces:\\
\sphinxstylestrong{\(\hat{\nu} = 3.63072\) and \(p = 0.0001\)}\\
This indicates a \sphinxstylestrong{strong decreasing trend} over time in the repeated measures setup.

\end{itemize}

\sphinxAtStartPar
These outputs validate the robustness of the \sphinxcode{\sphinxupquote{nonparTrendR\_test}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{}\PYGZsq{} Nonparametric Trend Test (Bathke, 2009)}
\PYG{c+c1}{\PYGZsh{}\PYGZsq{}}
\PYG{c+c1}{\PYGZsh{}\PYGZsq{} Performs a nonparametric trend test for independent or dependent samples}
\PYG{c+c1}{\PYGZsh{}\PYGZsq{} based on Bathke (2009).}
\PYG{c+c1}{\PYGZsh{}\PYGZsq{}}
\PYG{c+c1}{\PYGZsh{}\PYGZsq{} @param data For type = \PYGZdq{}I\PYGZdq{} (independent), a list of vectors;}
\PYG{c+c1}{\PYGZsh{}\PYGZsq{}             for type = \PYGZdq{}D\PYGZdq{} (dependent), a matrix.}
\PYG{c+c1}{\PYGZsh{}\PYGZsq{} @param type \PYGZdq{}I\PYGZdq{} or \PYGZdq{}D\PYGZdq{}}
\PYG{c+c1}{\PYGZsh{}\PYGZsq{} @param alternative \PYGZdq{}two.sided\PYGZdq{}, \PYGZdq{}increasing\PYGZdq{}, or \PYGZdq{}decreasing\PYGZdq{}}
\PYG{c+c1}{\PYGZsh{}\PYGZsq{}}
\PYG{c+c1}{\PYGZsh{}\PYGZsq{} @return A list with test statistic, p\PYGZhy{}value, method, data description}
\PYG{c+c1}{\PYGZsh{}\PYGZsq{} @export}

\PYG{n}{nonparTrendR\PYGZus{}test}\PYG{+w}{ }\PYG{o}{\PYGZlt{}\PYGZhy{}}\PYG{+w}{ }\PYG{n+nf}{function}\PYG{p}{(}\PYG{n}{data}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{type}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n+nf}{c}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{I\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{D\PYGZdq{}}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{alternative}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k+kc}{NULL}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{  }\PYG{n}{type}\PYG{+w}{ }\PYG{o}{\PYGZlt{}\PYGZhy{}}\PYG{+w}{ }\PYG{n+nf}{match.arg}\PYG{p}{(}\PYG{n}{type}\PYG{p}{)}
\PYG{+w}{  }\PYG{n}{data\PYGZus{}name}\PYG{+w}{ }\PYG{o}{\PYGZlt{}\PYGZhy{}}\PYG{+w}{ }\PYG{n+nf}{deparse}\PYG{p}{(}\PYG{n+nf}{substitute}\PYG{p}{(}\PYG{n}{data}\PYG{p}{)}\PYG{p}{)}

\PYG{+w}{  }\PYG{n+nf}{if }\PYG{p}{(}\PYG{n}{type}\PYG{+w}{ }\PYG{o}{==}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{I\PYGZdq{}}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{    }\PYG{c+c1}{\PYGZsh{} Independent Samples}
\PYG{+w}{    }\PYG{n+nf}{if }\PYG{p}{(}\PYG{o}{!}\PYG{n+nf}{is.list}\PYG{p}{(}\PYG{n}{data}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{||}\PYG{+w}{ }\PYG{o}{!}\PYG{n+nf}{all}\PYG{p}{(}\PYG{n+nf}{sapply}\PYG{p}{(}\PYG{n}{data}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{is.numeric}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{      }\PYG{n+nf}{stop}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{\PYGZsq{}data\PYGZsq{} must be a list of numeric vectors for type = \PYGZsq{}I\PYGZsq{}.\PYGZdq{}}\PYG{p}{)}
\PYG{+w}{    }\PYG{p}{\PYGZcb{}}
\PYG{+w}{    }\PYG{n+nf}{if }\PYG{p}{(}\PYG{n+nf}{length}\PYG{p}{(}\PYG{n}{data}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{\PYGZlt{}}\PYG{+w}{ }\PYG{l+m}{2}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{      }\PYG{n+nf}{stop}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{At least two groups are required.\PYGZdq{}}\PYG{p}{)}
\PYG{+w}{    }\PYG{p}{\PYGZcb{}}

\PYG{+w}{    }\PYG{n+nf}{if }\PYG{p}{(}\PYG{n+nf}{is.null}\PYG{p}{(}\PYG{n}{alternative}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{      }\PYG{n}{alternative}\PYG{+w}{ }\PYG{o}{\PYGZlt{}\PYGZhy{}}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{increasing\PYGZdq{}}
\PYG{+w}{    }\PYG{p}{\PYGZcb{}}
\PYG{+w}{    }\PYG{n}{alternative}\PYG{+w}{ }\PYG{o}{\PYGZlt{}\PYGZhy{}}\PYG{+w}{ }\PYG{n+nf}{match.arg}\PYG{p}{(}\PYG{n}{alternative}\PYG{p}{,}\PYG{+w}{ }\PYG{n+nf}{c}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{two.sided\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{increasing\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{decreasing\PYGZdq{}}\PYG{p}{)}\PYG{p}{)}

\PYG{+w}{    }\PYG{n}{group\PYGZus{}sizes}\PYG{+w}{ }\PYG{o}{\PYGZlt{}\PYGZhy{}}\PYG{+w}{ }\PYG{n+nf}{sapply}\PYG{p}{(}\PYG{n}{data}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{length}\PYG{p}{)}
\PYG{+w}{    }\PYG{n}{all\PYGZus{}obs}\PYG{+w}{ }\PYG{o}{\PYGZlt{}\PYGZhy{}}\PYG{+w}{ }\PYG{n+nf}{unlist}\PYG{p}{(}\PYG{n}{data}\PYG{p}{)}
\PYG{+w}{    }\PYG{n}{N}\PYG{+w}{ }\PYG{o}{\PYGZlt{}\PYGZhy{}}\PYG{+w}{ }\PYG{n+nf}{length}\PYG{p}{(}\PYG{n}{all\PYGZus{}obs}\PYG{p}{)}
\PYG{+w}{    }\PYG{n}{a}\PYG{+w}{ }\PYG{o}{\PYGZlt{}\PYGZhy{}}\PYG{+w}{ }\PYG{n+nf}{length}\PYG{p}{(}\PYG{n}{data}\PYG{p}{)}
\PYG{+w}{    }\PYG{n}{group\PYGZus{}ids}\PYG{+w}{ }\PYG{o}{\PYGZlt{}\PYGZhy{}}\PYG{+w}{ }\PYG{n+nf}{rep}\PYG{p}{(}\PYG{l+m}{1}\PYG{o}{:}\PYG{n}{a}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{times}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{group\PYGZus{}sizes}\PYG{p}{)}
\PYG{+w}{    }\PYG{n}{ranks}\PYG{+w}{ }\PYG{o}{\PYGZlt{}\PYGZhy{}}\PYG{+w}{ }\PYG{n+nf}{rank}\PYG{p}{(}\PYG{n}{all\PYGZus{}obs}\PYG{p}{)}
\PYG{+w}{    }\PYG{n}{group\PYGZus{}f}\PYG{+w}{ }\PYG{o}{\PYGZlt{}\PYGZhy{}}\PYG{+w}{ }\PYG{n+nf}{factor}\PYG{p}{(}\PYG{n}{group\PYGZus{}ids}\PYG{p}{)}
\PYG{+w}{    }\PYG{n}{Rik\PYGZus{}list}\PYG{+w}{ }\PYG{o}{\PYGZlt{}\PYGZhy{}}\PYG{+w}{ }\PYG{n+nf}{split}\PYG{p}{(}\PYG{n}{ranks}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{group\PYGZus{}f}\PYG{p}{)}
\PYG{+w}{    }\PYG{n}{Ri\PYGZus{}dot}\PYG{+w}{ }\PYG{o}{\PYGZlt{}\PYGZhy{}}\PYG{+w}{ }\PYG{n+nf}{sapply}\PYG{p}{(}\PYG{n}{Rik\PYGZus{}list}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{sum}\PYG{p}{)}

\PYG{+w}{    }\PYG{n}{weights}\PYG{+w}{ }\PYG{o}{\PYGZlt{}\PYGZhy{}}\PYG{+w}{ }\PYG{n+nf}{numeric}\PYG{p}{(}\PYG{n}{a}\PYG{p}{)}
\PYG{+w}{    }\PYG{n+nf}{for }\PYG{p}{(}\PYG{n}{i}\PYG{+w}{ }\PYG{n}{in}\PYG{+w}{ }\PYG{l+m}{1}\PYG{o}{:}\PYG{n}{a}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{      }\PYG{n}{left}\PYG{+w}{ }\PYG{o}{\PYGZlt{}\PYGZhy{}}\PYG{+w}{ }\PYG{n+nf}{if }\PYG{p}{(}\PYG{n}{i}\PYG{+w}{ }\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{l+m}{1}\PYG{p}{)}\PYG{+w}{ }\PYG{n+nf}{sum}\PYG{p}{(}\PYG{n}{group\PYGZus{}sizes}\PYG{p}{[}\PYG{l+m}{1}\PYG{o}{:}\PYG{p}{(}\PYG{n}{i}\PYG{+w}{ }\PYG{o}{\PYGZhy{}}\PYG{+w}{ }\PYG{l+m}{1}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}\PYG{+w}{ }\PYG{n}{else}\PYG{+w}{ }\PYG{l+m}{0}
\PYG{+w}{      }\PYG{n}{right}\PYG{+w}{ }\PYG{o}{\PYGZlt{}\PYGZhy{}}\PYG{+w}{ }\PYG{n+nf}{if }\PYG{p}{(}\PYG{n}{i}\PYG{+w}{ }\PYG{o}{\PYGZlt{}}\PYG{+w}{ }\PYG{n}{a}\PYG{p}{)}\PYG{+w}{ }\PYG{n+nf}{sum}\PYG{p}{(}\PYG{n}{group\PYGZus{}sizes}\PYG{p}{[}\PYG{p}{(}\PYG{n}{i}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{l+m}{1}\PYG{p}{)}\PYG{o}{:}\PYG{n}{a}\PYG{p}{]}\PYG{p}{)}\PYG{+w}{ }\PYG{n}{else}\PYG{+w}{ }\PYG{l+m}{0}
\PYG{+w}{      }\PYG{n}{weights}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{+w}{ }\PYG{o}{\PYGZlt{}\PYGZhy{}}\PYG{+w}{ }\PYG{n}{left}\PYG{+w}{ }\PYG{o}{\PYGZhy{}}\PYG{+w}{ }\PYG{n}{right}
\PYG{+w}{    }\PYG{p}{\PYGZcb{}}

\PYG{+w}{    }\PYG{n}{numerator}\PYG{+w}{ }\PYG{o}{\PYGZlt{}\PYGZhy{}}\PYG{+w}{ }\PYG{n+nf}{sum}\PYG{p}{(}\PYG{n}{weights}\PYG{+w}{ }\PYG{o}{*}\PYG{+w}{ }\PYG{n}{Ri\PYGZus{}dot}\PYG{p}{)}
\PYG{+w}{    }\PYG{n}{denominator\PYGZus{}sum}\PYG{+w}{ }\PYG{o}{\PYGZlt{}\PYGZhy{}}\PYG{+w}{ }\PYG{l+m}{0}
\PYG{+w}{    }\PYG{n+nf}{for }\PYG{p}{(}\PYG{n}{i}\PYG{+w}{ }\PYG{n}{in}\PYG{+w}{ }\PYG{l+m}{1}\PYG{o}{:}\PYG{n}{a}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{      }\PYG{n}{ni}\PYG{+w}{ }\PYG{o}{\PYGZlt{}\PYGZhy{}}\PYG{+w}{ }\PYG{n}{group\PYGZus{}sizes}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}
\PYG{+w}{      }\PYG{n}{Rik}\PYG{+w}{ }\PYG{o}{\PYGZlt{}\PYGZhy{}}\PYG{+w}{ }\PYG{n}{Rik\PYGZus{}list}\PYG{p}{[[}\PYG{n}{i}\PYG{p}{]]}
\PYG{+w}{      }\PYG{n}{deviations}\PYG{+w}{ }\PYG{o}{\PYGZlt{}\PYGZhy{}}\PYG{+w}{ }\PYG{n}{Rik}\PYG{+w}{ }\PYG{o}{\PYGZhy{}}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{N}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{l+m}{1}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{/}\PYG{+w}{ }\PYG{l+m}{2}
\PYG{+w}{      }\PYG{n}{term}\PYG{+w}{ }\PYG{o}{\PYGZlt{}\PYGZhy{}}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{ni}\PYG{+w}{ }\PYG{o}{/}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{ni}\PYG{+w}{ }\PYG{o}{\PYGZhy{}}\PYG{+w}{ }\PYG{l+m}{1}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{*}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{weights}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{o}{\PYGZca{}}\PYG{l+m}{2}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{*}\PYG{+w}{ }\PYG{n+nf}{sum}\PYG{p}{(}\PYG{n}{deviations}\PYG{o}{\PYGZca{}}\PYG{l+m}{2}\PYG{p}{)}
\PYG{+w}{      }\PYG{n}{denominator\PYGZus{}sum}\PYG{+w}{ }\PYG{o}{\PYGZlt{}\PYGZhy{}}\PYG{+w}{ }\PYG{n}{denominator\PYGZus{}sum}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{n}{term}
\PYG{+w}{    }\PYG{p}{\PYGZcb{}}

\PYG{+w}{    }\PYG{n}{nu\PYGZus{}hat}\PYG{+w}{ }\PYG{o}{\PYGZlt{}\PYGZhy{}}\PYG{+w}{ }\PYG{n+nf}{ifelse}\PYG{p}{(}\PYG{n}{denominator\PYGZus{}sum}\PYG{+w}{ }\PYG{o}{\PYGZlt{}=}\PYG{+w}{ }\PYG{l+m}{1e\PYGZhy{}10}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m}{0}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{numerator}\PYG{+w}{ }\PYG{o}{/}\PYG{+w}{ }\PYG{n+nf}{sqrt}\PYG{p}{(}\PYG{n}{denominator\PYGZus{}sum}\PYG{p}{)}\PYG{p}{)}
\PYG{+w}{    }\PYG{n}{method\PYGZus{}str}\PYG{+w}{ }\PYG{o}{\PYGZlt{}\PYGZhy{}}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{Bathke Nonparametric Trend Test (Independent Samples)\PYGZdq{}}
\PYG{+w}{  }\PYG{p}{\PYGZcb{}}

\PYG{+w}{  }\PYG{n}{else}\PYG{+w}{ }\PYG{n+nf}{if }\PYG{p}{(}\PYG{n}{type}\PYG{+w}{ }\PYG{o}{==}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{D\PYGZdq{}}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{    }\PYG{c+c1}{\PYGZsh{} Dependent Samples}
\PYG{+w}{    }\PYG{n+nf}{if }\PYG{p}{(}\PYG{o}{!}\PYG{n+nf}{is.matrix}\PYG{p}{(}\PYG{n}{data}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{      }\PYG{n+nf}{stop}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{\PYGZsq{}data\PYGZsq{} must be a numeric matrix for type = \PYGZsq{}D\PYGZsq{}.\PYGZdq{}}\PYG{p}{)}
\PYG{+w}{    }\PYG{p}{\PYGZcb{}}

\PYG{+w}{    }\PYG{n}{n}\PYG{+w}{ }\PYG{o}{\PYGZlt{}\PYGZhy{}}\PYG{+w}{ }\PYG{n+nf}{nrow}\PYG{p}{(}\PYG{n}{data}\PYG{p}{)}
\PYG{+w}{    }\PYG{n}{b}\PYG{+w}{ }\PYG{o}{\PYGZlt{}\PYGZhy{}}\PYG{+w}{ }\PYG{n+nf}{ncol}\PYG{p}{(}\PYG{n}{data}\PYG{p}{)}
\PYG{+w}{    }\PYG{n+nf}{if }\PYG{p}{(}\PYG{n+nf}{is.null}\PYG{p}{(}\PYG{n}{alternative}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{      }\PYG{n}{alternative}\PYG{+w}{ }\PYG{o}{\PYGZlt{}\PYGZhy{}}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{increasing\PYGZdq{}}
\PYG{+w}{    }\PYG{p}{\PYGZcb{}}
\PYG{+w}{    }\PYG{n}{alternative}\PYG{+w}{ }\PYG{o}{\PYGZlt{}\PYGZhy{}}\PYG{+w}{ }\PYG{n+nf}{match.arg}\PYG{p}{(}\PYG{n}{alternative}\PYG{p}{,}\PYG{+w}{ }\PYG{n+nf}{c}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{two.sided\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{increasing\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{decreasing\PYGZdq{}}\PYG{p}{)}\PYG{p}{)}

\PYG{+w}{    }\PYG{n}{ranks}\PYG{+w}{ }\PYG{o}{\PYGZlt{}\PYGZhy{}}\PYG{+w}{ }\PYG{n+nf}{matrix}\PYG{p}{(}\PYG{n+nf}{rank}\PYG{p}{(}\PYG{n}{data}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{nrow}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{n}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{ncol}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{b}\PYG{p}{)}
\PYG{+w}{    }\PYG{n}{Rj\PYGZus{}dot}\PYG{+w}{ }\PYG{o}{\PYGZlt{}\PYGZhy{}}\PYG{+w}{ }\PYG{n+nf}{colSums}\PYG{p}{(}\PYG{n}{ranks}\PYG{p}{)}
\PYG{+w}{    }\PYG{n}{wj}\PYG{+w}{ }\PYG{o}{\PYGZlt{}\PYGZhy{}}\PYG{+w}{ }\PYG{p}{(}\PYG{l+m}{1}\PYG{o}{:}\PYG{n}{b}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{\PYGZhy{}}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{b}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{l+m}{1}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{/}\PYG{+w}{ }\PYG{l+m}{2}
\PYG{+w}{    }\PYG{n+nf}{if }\PYG{p}{(}\PYG{n}{alternative}\PYG{+w}{ }\PYG{o}{==}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{decreasing\PYGZdq{}}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{      }\PYG{n}{wj}\PYG{+w}{ }\PYG{o}{\PYGZlt{}\PYGZhy{}}\PYG{+w}{ }\PYG{n+nf}{rev}\PYG{p}{(}\PYG{n}{wj}\PYG{p}{)}
\PYG{+w}{    }\PYG{p}{\PYGZcb{}}

\PYG{+w}{    }\PYG{n}{numerator}\PYG{+w}{ }\PYG{o}{\PYGZlt{}\PYGZhy{}}\PYG{+w}{ }\PYG{n+nf}{sum}\PYG{p}{(}\PYG{n}{wj}\PYG{+w}{ }\PYG{o}{*}\PYG{+w}{ }\PYG{n}{Rj\PYGZus{}dot}\PYG{p}{)}
\PYG{+w}{    }\PYG{n}{mean\PYGZus{}rank}\PYG{+w}{ }\PYG{o}{\PYGZlt{}\PYGZhy{}}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{n}\PYG{+w}{ }\PYG{o}{*}\PYG{+w}{ }\PYG{n}{b}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{l+m}{1}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{/}\PYG{+w}{ }\PYG{l+m}{2}
\PYG{+w}{    }\PYG{n}{s\PYGZus{}v\PYGZus{}hat\PYGZus{}squared}\PYG{+w}{ }\PYG{o}{\PYGZlt{}\PYGZhy{}}\PYG{+w}{ }\PYG{l+m}{0}
\PYG{+w}{    }\PYG{n+nf}{for }\PYG{p}{(}\PYG{n}{j}\PYG{+w}{ }\PYG{n}{in}\PYG{+w}{ }\PYG{l+m}{1}\PYG{o}{:}\PYG{n}{b}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{      }\PYG{n}{s\PYGZus{}v\PYGZus{}hat\PYGZus{}squared}\PYG{+w}{ }\PYG{o}{\PYGZlt{}\PYGZhy{}}\PYG{+w}{ }\PYG{n}{s\PYGZus{}v\PYGZus{}hat\PYGZus{}squared}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{n}{wj}\PYG{p}{[}\PYG{n}{j}\PYG{p}{]}\PYG{o}{\PYGZca{}}\PYG{l+m}{2}\PYG{+w}{ }\PYG{o}{*}\PYG{+w}{ }\PYG{n+nf}{sum}\PYG{p}{(}\PYG{p}{(}\PYG{n}{ranks}\PYG{p}{[}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{j}\PYG{p}{]}\PYG{+w}{ }\PYG{o}{\PYGZhy{}}\PYG{+w}{ }\PYG{n}{mean\PYGZus{}rank}\PYG{p}{)}\PYG{o}{\PYGZca{}}\PYG{l+m}{2}\PYG{p}{)}
\PYG{+w}{    }\PYG{p}{\PYGZcb{}}
\PYG{+w}{    }\PYG{n+nf}{for }\PYG{p}{(}\PYG{n}{j}\PYG{+w}{ }\PYG{n}{in}\PYG{+w}{ }\PYG{l+m}{1}\PYG{o}{:}\PYG{n}{b}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{      }\PYG{n+nf}{for }\PYG{p}{(}\PYG{n}{l}\PYG{+w}{ }\PYG{n}{in}\PYG{+w}{ }\PYG{l+m}{1}\PYG{o}{:}\PYG{n}{b}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{        }\PYG{n+nf}{if }\PYG{p}{(}\PYG{n}{j}\PYG{+w}{ }\PYG{o}{==}\PYG{+w}{ }\PYG{n}{l}\PYG{p}{)}\PYG{+w}{ }\PYG{n}{next}
\PYG{+w}{        }\PYG{n}{s\PYGZus{}v\PYGZus{}hat\PYGZus{}squared}\PYG{+w}{ }\PYG{o}{\PYGZlt{}\PYGZhy{}}\PYG{+w}{ }\PYG{n}{s\PYGZus{}v\PYGZus{}hat\PYGZus{}squared}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{n}{wj}\PYG{p}{[}\PYG{n}{j}\PYG{p}{]}\PYG{+w}{ }\PYG{o}{*}\PYG{+w}{ }\PYG{n}{wj}\PYG{p}{[}\PYG{n}{l}\PYG{p}{]}\PYG{+w}{ }\PYG{o}{*}\PYG{+w}{ }\PYG{n+nf}{sum}\PYG{p}{(}\PYG{p}{(}\PYG{n}{ranks}\PYG{p}{[}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{j}\PYG{p}{]}\PYG{+w}{ }\PYG{o}{\PYGZhy{}}\PYG{+w}{ }\PYG{n}{mean\PYGZus{}rank}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{*}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{ranks}\PYG{p}{[}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{l}\PYG{p}{]}\PYG{+w}{ }\PYG{o}{\PYGZhy{}}\PYG{+w}{ }\PYG{n}{mean\PYGZus{}rank}\PYG{p}{)}\PYG{p}{)}
\PYG{+w}{      }\PYG{p}{\PYGZcb{}}
\PYG{+w}{    }\PYG{p}{\PYGZcb{}}

\PYG{+w}{    }\PYG{n}{nu\PYGZus{}hat}\PYG{+w}{ }\PYG{o}{\PYGZlt{}\PYGZhy{}}\PYG{+w}{ }\PYG{n+nf}{ifelse}\PYG{p}{(}\PYG{n}{s\PYGZus{}v\PYGZus{}hat\PYGZus{}squared}\PYG{+w}{ }\PYG{o}{\PYGZlt{}=}\PYG{+w}{ }\PYG{l+m}{1e\PYGZhy{}10}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m}{0}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{numerator}\PYG{+w}{ }\PYG{o}{/}\PYG{+w}{ }\PYG{n+nf}{sqrt}\PYG{p}{(}\PYG{n}{s\PYGZus{}v\PYGZus{}hat\PYGZus{}squared}\PYG{p}{)}\PYG{p}{)}
\PYG{+w}{    }\PYG{n}{method\PYGZus{}str}\PYG{+w}{ }\PYG{o}{\PYGZlt{}\PYGZhy{}}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{Bathke Nonparametric Trend Test (Dependent Samples)\PYGZdq{}}
\PYG{+w}{  }\PYG{p}{\PYGZcb{}}

\PYG{+w}{  }\PYG{n}{p\PYGZus{}value}\PYG{+w}{ }\PYG{o}{\PYGZlt{}\PYGZhy{}}\PYG{+w}{ }\PYG{n+nf}{switch}\PYG{p}{(}
\PYG{+w}{    }\PYG{n}{alternative}\PYG{p}{,}
\PYG{+w}{    }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{two.sided\PYGZdq{}}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{l+m}{2}\PYG{+w}{ }\PYG{o}{*}\PYG{+w}{ }\PYG{p}{(}\PYG{l+m}{1}\PYG{+w}{ }\PYG{o}{\PYGZhy{}}\PYG{+w}{ }\PYG{n+nf}{pnorm}\PYG{p}{(}\PYG{n+nf}{abs}\PYG{p}{(}\PYG{n}{nu\PYGZus{}hat}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,}
\PYG{+w}{    }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{increasing\PYGZdq{}}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{l+m}{1}\PYG{+w}{ }\PYG{o}{\PYGZhy{}}\PYG{+w}{ }\PYG{n+nf}{pnorm}\PYG{p}{(}\PYG{n}{nu\PYGZus{}hat}\PYG{p}{)}\PYG{p}{,}
\PYG{+w}{    }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{decreasing\PYGZdq{}}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n+nf}{pnorm}\PYG{p}{(}\PYG{n}{nu\PYGZus{}hat}\PYG{p}{)}
\PYG{+w}{  }\PYG{p}{)}

\PYG{+w}{  }\PYG{n+nf}{names}\PYG{p}{(}\PYG{n}{nu\PYGZus{}hat}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{\PYGZlt{}\PYGZhy{}}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{nu\PYGZus{}hat\PYGZdq{}}
\PYG{+w}{  }\PYG{n+nf}{return}\PYG{p}{(}\PYG{n+nf}{structure}\PYG{p}{(}\PYG{n+nf}{list}\PYG{p}{(}\PYG{n}{statistic}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{nu\PYGZus{}hat}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{p.value}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{p\PYGZus{}value}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{alternative}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{alternative}\PYG{p}{,}
\PYG{+w}{                        }\PYG{n}{method}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{method\PYGZus{}str}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{data.name}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{data\PYGZus{}name}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{class}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{htest\PYGZdq{}}\PYG{p}{)}\PYG{p}{)}
\PYG{p}{\PYGZcb{}}
\end{sphinxVerbatim}







\renewcommand{\indexname}{Index}
\printindex
\end{document}